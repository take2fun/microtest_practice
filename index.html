<!doctype html>
<html>

<head>
  <meta charset="utf-8">
  <title>実験</title>
  <script src="processing.js"></script>
</head>

<body class="box">
  <script type="text/processing">
//non-liner
//Good Design
//random presure

// メモ帳のやつの記入欄の追加　これはFormの方をいじればOK


int scene = 1;

float time = 0;
float time2 = 0;
float base_time = 0;
float base_timeA = 0;

int f = 0;
float n = 0;

int trust_time = 0;

int rA = int(random(0, 13));
int rB = int(random(0, 5));

int rank = int(random(1, 5));
String Word[][] = {{"包丁",1},{"フライパン",3},{"ボウル",2},{"まな板",4},{"計量器",1},{"フライ返し",3},{"ざる",2},{"耐熱皿",4},{"蒸し器",1},{"ナイフ",3},{"フォーク",2},{"スプーン",4},{"菜箸",2}};
String wordA[] = {"洗濯機", "テレビ", "カメラ", "炊飯器", "パソコン", "エアコン", "レンジ", "イス", "ベッド", "プリンター", "つくえ", "加湿器", "除湿機"};
String wordB[] = {"1", "3", "2", "4"};

int count_answer = 0;
int count_time[] = {};
float before_time = 0;

String presureList[] = {"Low","High"};
int presure_selecter = 0;
String play_presure = "";

void setup() {
  size(700, 300);
  background(255);
  PFont font = createFont("utf-8", 50);
  textFont(font);
  document.getElementById('area').style.fontSize = 150+"%";
  document.getElementById('a_area').style.fontSize = 150+"%";
  document.getElementById('b_area').style.fontSize = 150+"%";

  presure_selecter = int(random(0,2));
}

void draw() {
  background(255);
  switch(scene) {
  case 1:
    fill(0);
    textSize(56);
    textAlign(CENTER);
    text("Enterキーを押すとスタート", width/2, height/2);
    play_presure = presureList[presure_selecter];
    //text(play_presure,width/2,height/4);
    //text(Word[0][1],width/2,height/4);

    break;

  case 2:
    background(255);
    textSize(46);
    textAlign(CENTER);
    fill(0);
    text("残り時間", width/2-135, height/4-20);
    text("検索ワード", width/2-170, height/2+50);
    text("順位", width*3/4, height/2+50);
    text(Word[rA][0], width/2-210, height/2+110);
    //text(wordB[rB], width/2-40, height/2+60);
    text(Word[rA][1], width*3/4, height/2+110);
    //text("Push Enterkey to Next", width/2, height*3/4+70);
    noFill();
    //progressBar
    rect(width/2-250, height/4, 500, 500/16);


    //display information
    timer();
    makeProgressBar();
    nextScene();

    break;
  case 3:
    size(700, 130);
    background(255);
    textSize(30);
    textAlign(CENTER);
    fill(0);
    text("終了です．", width/2, height/4);
    text("ご協力ありがとうございます．", width/2, height/4+30);
    text("このページを閉じずに，残したまま，", width/2, height/4+60);
    text("アンケートフォームにお戻りください．", width/2, height/4+90);
    //println(count_answer);
    //println(count_time);
    noLoop();
    document.getElementById('presure_area').innerHTML = "タイプ："+play_presure;
    document.getElementById('answer_area').innerHTML = "回答数："+count_answer;
    document.getElementById('timer_area').innerHTML = "回答時間："+count_time;
  }
}

void timer() {
  if(play_presure == "High"){
    if (base_time == 0) {
        base_time = millis();
      }
      time = millis() - base_time;
      time = time/1000;
      trust_time = time;
      //text("true_time:"+int(time), width/2, height/2+10);
      if (time < 240) {
        f = 1;
        time = time * 3/2;
        //text("fast_time:"+int(time), width/2, height/2);
        //text("fast", width/2, height/2-200);
      } else if (time >= 240) {
        f = 2;
        if (base_timeA == 0) {

          base_timeA = millis();
        }
        time2 = millis() - base_timeA;
        time2 = time2/1000;

        time2 = time2 * 3/2;
        time2 = time2 + 360;
        //text("slow_time:"+int(t), width/2, height/2);
        //text("slow", width/2, height/2-200);
      }
  }else if(play_presure == "Low"){
    if (base_time == 0) {
      base_time = millis();
    }
    time = millis() - base_time;
    time = time/1000;
    trust_time = time;
    //text("true_time:"+int(time), width/2, height/2+10);
    if (time < 360) {
      f = 1;
      time = time * 2/3;
      //text("slow_time:"+int(time), width/2, height/2);
      //text("fast", width/2, height/2-200);
    } else if (time >= 360) {
      f = 2;
      if (base_timeA == 0) {
        base_timeA = millis();
      }
      time2 = millis() - base_timeA;
      time2 = time2/1000;

      time2 = time2 * 3/2;
      time2 = time2 + 240;
      //text("fast_time:"+int(time), width/2, height/2);
      //text("slow", width/2, height/2-200);
    }
  }
}



void makeProgressBar() {
  if (f == 1) {
    n = (600-time)/6;
  } else if (f == 2) {
    n = (600-time2)/6;
  }
  fill(0, 255, 0);
  for (int i = 0; i < n; i++) {
    if (scene == 2) {
      rect((width/2+250)-5*i, height/4, 5, 500/16);
    }
  }
}


void nextScene() {
  if (n < 0) {
    scene = 3;
  }
}


void keyReleased() {
  if (scene == 1) {
    if (keyCode == ENTER) {
      scene = 2;
    }
  } else if (scene == 2) {
    if (keyCode == ENTER) {
      count_answer += 1;
      Word[rA][1] = Word[rA][1] + 1;
      if(Word[rA][1] > 4){
        Word[rA][1] = 1;
      }

      if (int(trust_time - before_time) == 0) {
      }else{
        count_time = append(count_time, int(trust_time-before_time));
        before_time = trust_time;
      }

      rA = int(random(0, 13));
      rB = int(random(0, 5));
      rank = int(random(1, 5));
    }
  }
}


    </script>
  <canvas></canvas>
  <p id="area">語群</p>
  <p id="a_area">包丁　フライパン　ボウル　まな板　計量器　フライ返し</p>
  <p id="b_area">ざる　耐熱皿　蒸し器　ナイフ　フォーク　スプーン　菜箸</p>

  <div id="presure_area"></div>
  <div id="answer_area"></div>
  <div id="timer_area"></div>
</body>

</html>
